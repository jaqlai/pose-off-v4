<!doctype html>
<html lang="em">
<head>
    <meta charset="UTF-8">
    <title>Pose Off!</title>
    <link rel="stylesheet" type="text/css" href="/css/style.css">
    <!-- Load TensorFlow.js -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.2"></script>
    <!-- Load BodyPix -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/body-pix@2.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <!-- production version, optimized for size and speed -->
<!-- <script src="https://cdn.jsdelivr.net/npm/vue"></script> -->

</head>

<body>
    <div id="overlay">hello</div>
<div id="main">
    <img id="streamImg">
    <canvas id = "streamCanvas"></canvas>
    <canvas id = "diffCanvas"></canvas>
    <canvas id = "drawCanvas"></canvas>
    <div id="vidContainer" style="display:none">
    <video id="myVid" autoplay playsinline style="display:none"></video>
</div>

</div>
<div id="dashboard">
    <p>Status: <span id="userMessage">Webcam must be activated.</span></p>
    <div id="statsDiv" hidden>
        <p>FPS: <span id="fps"></span></p>
    </div>
    <div id="controls">

        <!-- <p>Trade off speed for accuracy:</p>
        <button id="highSpeed" disabled>Faster</button>
        <button id="normalSpeed" disabled>Normal</button>
        <button id="lowerSpeed" disabled>More accurate</button>
        <button id="lowSpeed" disabled>Most accurate</button> -->

    </div>
</div>
<!-- 
<li class="login page">
    <div class="form">
      <h3 class="title">join a room:</h3>
      <input class="roomInput" type="text" maxlength="14" />
    </div>
</li> -->


<!-- include socket and jquery -->
<script src="/socket.io/socket.io.js"></script>
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="https://bundle.run/pixelmatch@5.0.1"></script>
<script src="/js/ui-helper.js"></script>
<script src="/js/scan.js"></script>

<!-- socket stuff -->
<script>

$(function () {
    if (location.hash) {
        thisRoom = location.hash;
        socket.emit('room-hash', thisRoom);
        //document.getElementById("room-display").innerHTML = "Current Room: "+location.hash;
    };

    socket.on('seg-stream', (data) => {
        $('#streamImg').attr('src',data);
    });

    socket.on('record', (ms) => {
        //recording for 3000 ms.
        userMessage.innerText = "Matching...";
        recording = true;
        setTimeout(function(){checkScore(ms);}, ms);

    });

// compare the two images
    function foo() {
    socket.emit('run-match', drawCanvas.toDataURL('image/webp'));
    // console.log("lmfao");
    setTimeout(foo, 100);
    }

    foo();
});

// document.getElementById("overlay").style.opacity = 1;
</script>



<!-- <script src="/js/output.js"></script> -->

</body>
</html>
